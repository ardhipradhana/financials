<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Statement Generator - MontPro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        
        /* 1. Root Variables & Base Styles */
        :root {
            --primary-blue: #1D3557;
            --background-grey: #F8F9FA;
            --container-white: #FFFFFF;
            --text-color: #212529;
            --accent-green: #2A9D8F;
            --border-grey: #CED4DA;
            --error-red: #E63946;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--background-grey);
            color: var(--text-color);
            min-height: 100vh;
        }

        /* 2. Layout & Container */
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 30px;
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 600;
        }
        .back-link:hover { text-decoration: underline; }

        /* 3. Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
        }
        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }
        .tagline {
            font-size: 1.15rem;
            color: #6c757d; /* A secondary text color */
        }

        /* 4. Progress Bar */
        .progress-container {
            display: flex;
            align-items: center;
            width: 100%;
            margin-bottom: 40px;
        }
        .progress-step {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            transition: all 0.3s ease;
            background-color: var(--container-white);
            border: 2px solid var(--border-grey);
            color: var(--border-grey);
        }
        .step-circle.active {
            border-color: var(--accent-green);
            background-color: var(--accent-green);
            color: white;
        }
        .step-circle.completed {
            border-color: var(--primary-blue);
            background-color: var(--primary-blue);
            color: white;
        }
        .step-label {
            font-weight: 600;
            color: #6c757d;
        }
        .progress-step.active .step-label {
            color: var(--text-color);
        }
        .progress-line {
            flex-grow: 1;
            height: 2px;
            background-color: var(--border-grey);
            margin: 0 20px;
        }

        /* 5. Main Content Wizard */
        .wizard-content {
            background-color: var(--container-white);
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 50px 60px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .step-section { display: none; }
        .step-section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .step-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 12px;
        }
        .step-description {
            color: #6c757d;
            margin-bottom: 40px;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        /* 6. Form Elements */
        .form-group { margin-bottom: 25px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 600; }
        .form-input, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-grey);
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.2);
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }

        /* 7. Upload Area */
        .upload-primary {
            border: 2px dashed var(--border-grey);
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background-color: #f8f9fa;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .upload-primary:hover, .upload-primary.drag-over {
            border-color: var(--accent-green);
            background-color: #eef7f6;
        }
        .upload-icon { font-size: 3rem; color: var(--accent-green); margin-bottom: 15px; }
        .upload-text { font-size: 1.1rem; font-weight: 600; color: var(--primary-blue); }
        .upload-hint { font-size: 0.9rem; color: #6c757d; margin-top: 4px; }

        .file-list { margin-top: 15px; display: flex; flex-direction: column; gap: 8px; }
        .file-item { display: flex; align-items: center; justify-content: space-between; background: #f8f9fa; padding: 10px; border-radius: 6px; border: 1px solid #dee2e6; }
        .file-remove { background: none; border: none; color: var(--error-red); font-size: 1.2rem; cursor: pointer; }

        /* 8. Buttons */
        .btn { padding: 12px 28px; border: none; border-radius: 6px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; text-decoration: none; display: inline-block; }
        .btn-primary { background-color: var(--accent-green); color: white; }
        .btn-primary:hover { background-color: #248a7e; }
        .btn-secondary { background-color: #e9ecef; color: var(--text-color); border: 1px solid var(--border-grey); }
        .btn-secondary:hover { background-color: #d8dde2; }
        .btn-container { display: flex; justify-content: space-between; align-items: center; margin-top: 50px; padding-top: 30px; border-top: 1px solid #dee2e6; }

        /* 9. Final Success & Loading States */
        .success-icon { font-size: 5rem; color: var(--accent-green); margin-bottom: 20px; }
        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8); display: none; align-items: center; justify-content: center; z-index: 1000; backdrop-filter: blur(4px); }
        .loading-overlay.show { display: flex; }
        .loading-spinner { font-size: 3rem; color: var(--primary-blue); animation: spin 1.5s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Home</a>
        
        <header class="header">
            <h1 class="logo">Financial Statement Generator</h1>
            <p class="tagline">Securely upload your bank statements to generate professional reports.</p>
        </header>

        <div class="progress-container">
            <div class="progress-step active" id="step1-progress">
                <div class="step-circle active" id="step1-circle">1</div>
                <div class="step-label">Company Info</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" id="step2-progress">
                <div class="step-circle" id="step2-circle">2</div>
                <div class="step-label">Upload Documents</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" id="step3-progress">
                <div class="step-circle" id="step3-circle"><i class="fas fa-flag-checkered"></i></div>
                <div class="step-label">Finish</div>
            </div>
        </div>

        <div class="wizard-content">
            <div class="step-section active" id="step1">
                <h2 class="step-title">Company Details</h2>
                <p class="step-description">Start by providing some basic information about your business. This will be used to title your financial reports.</p>
                <div class="form-group"><label class="form-label" for="companyName">Company Name</label><input type="text" id="companyName" class="form-input" placeholder="e.g. Acme Inc."></div>
                <div class="form-row">
                    <div class="form-group"><label class="form-label" for="industry">Industry</label><select id="industry" class="form-select"><option value="">Select industry</option><option value="manufacturing">Manufacturing</option><option value="retail">Retail & Trade</option><option value="services">Professional Services</option><option value="other">Other</option></select></div>
                    <div class="form-group"><label class="form-label" for="businessSize">Business Size</label><select id="businessSize" class="form-select"><option value="">Select size</option><option value="micro">Micro (1-9 employees)</option><option value="small">Small (10-49 employees)</option><option value="medium">Medium (50-249 employees)</option></select></div>
                </div>
                <div class="btn-container"><div/>
                    <button class="btn btn-primary" onclick="nextStep()">Continue <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>

            <div class="step-section" id="step2">
                <h2 class="step-title">Upload Bank Statements</h2>
                <p class="step-description">Upload your bank statements in PDF format. Our secure system will process them. We recommend 3-6 months of statements for an accurate report.</p>
                <div class="upload-primary" id="uploadArea">
                    <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                    <div class="upload-text">Drag & drop PDF files here</div>
                    <div class="upload-hint">or click to browse</div>
                    <input type="file" id="bankStatements" style="display: none;" multiple accept=".pdf">
                </div>
                <div class="file-list" id="bankStatementsList"></div>
                <div class="btn-container">
                    <button class="btn btn-secondary" onclick="prevStep()"><i class="fas fa-arrow-left"></i> Back</button>
                    <button class="btn btn-primary" id="processBtn" onclick="processFiles()">Generate Report <i class="fas fa-cogs"></i></button>
                </div>
            </div>

            <div class="step-section" id="step3">
                <div style="text-align: center;">
                    <div class="success-icon"><i class="fas fa-check-circle"></i></div>
                    <h2 class="step-title">Report Generation Complete!</h2>
                    <p class="step-description">Your financial statements are ready. You can now download the report or proceed to our analysis tool for deeper insights.</p>
                    <div class="btn-container" style="justify-content: center; gap: 20px;">
                        <button class="btn btn-primary" onclick="alert('Download functionality coming soon!')"><i class="fas fa-download"></i> Download Report (PDF)</button>
                        <a href="analysis.html" class="btn btn-secondary"><i class="fas fa-chart-line"></i> Analyze Statements</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <i class="fas fa-spinner loading-spinner"></i>
    </div>

    <script>
        let currentStep = 1;
        let bankStatementFiles = [];
    
        // --- Core Navigation Logic ---
    
        function updateProgressUI() {
            // Deactivate all steps first
            document.querySelectorAll('.progress-step').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.step-circle').forEach(el => {
                el.classList.remove('active');
                el.classList.remove('completed');
            });
    
            // Activate steps up to the current one
            for (let i = 1; i <= 3; i++) {
                const circle = document.getElementById(`step${i}-circle`);
                if (i < currentStep) {
                    document.getElementById(`step${i}-progress`).classList.add('active');
                    circle.classList.add('completed');
                } else if (i === currentStep) {
                    document.getElementById(`step${i}-progress`).classList.add('active');
                    circle.classList.add('active');
                }
            }
        }
    
        function nextStep() {
            console.log(`Attempting to move from step ${currentStep}`);
    
            // --- VALIDATION ADDED BACK ---
            // Validate Step 1 before proceeding
            if (currentStep === 1) {
                const companyName = document.getElementById('companyName').value.trim();
                if (companyName === '') {
                    alert('Please enter a Company Name to continue.');
                    return; // Stop the function if validation fails
                }
            }
    
            if (currentStep < 3) {
                // Hide current step
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                // Increment step and show the new one
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                console.log(`Successfully moved to step ${currentStep}`);
                updateProgressUI();
            }
        }
    
        function prevStep() {
            console.log(`Attempting to move back from step ${currentStep}`);
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                console.log(`Successfully moved back to step ${currentStep}`);
                updateProgressUI();
            }
        }
    
        function processFiles() {
            if (bankStatementFiles.length === 0) {
                alert('Please select at least one bank statement PDF to continue.');
                return;
            }
            document.getElementById('loadingOverlay').classList.add('show');
            setTimeout(() => {
                document.getElementById('loadingOverlay').classList.remove('show');
                nextStep(); // This moves from step 2 to the final step 3
            }, 2500);
        }
    
        // --- File Upload Handling ---
        const fileInput = document.getElementById('bankStatements');
        const uploadArea = document.getElementById('uploadArea');
    
        uploadArea.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
        
        uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('drag-over'); });
        uploadArea.addEventListener('dragleave', (e) => { e.preventDefault(); uploadArea.classList.remove('drag-over'); });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            handleFiles(e.dataTransfer.files);
        });
    
        function handleFiles(files) {
            const pdfFiles = Array.from(files).filter(file => file.type === 'application/pdf');
            if (pdfFiles.length > 0) {
                bankStatementFiles = [...bankStatementFiles, ...pdfFiles];
                updateFileDisplay();
            } else {
                alert('Only PDF files are accepted for bank statements.');
            }
        }
    
        function updateFileDisplay() {
            const fileListEl = document.getElementById('bankStatementsList');
            fileListEl.innerHTML = '';
            bankStatementFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span><i class="fas fa-file-pdf" style="color: #E63946; margin-right: 8px;"></i> ${file.name}</span>
                    <button class="file-remove" onclick="removeFile(event, ${index})"><i class="fas fa-times-circle"></i></button>
                `;
                fileListEl.appendChild(fileItem);
            });
        }
    
        function removeFile(event, index) {
            event.stopPropagation();
            bankStatementFiles.splice(index, 1);
            updateFileDisplay();
        }
        
        // Initialize the UI on page load
        updateProgressUI();
    </script>
</body>
</html>
